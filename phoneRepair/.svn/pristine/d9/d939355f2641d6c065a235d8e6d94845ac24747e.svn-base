define("component:components/lbc-verification-code/verificationCode.js",function(e,i,t){var o=e("component:components/jquery/jquery.js");e("component:components/jquery-ui/ui/jquery.ui.core.js"),e("component:components/jquery-ui/ui/jquery.ui.widget.js"),e("component:components/lbc-iajax/iAjax.js"),e("component:components/jquery-cookie/jquery.cookie.js");var n=(e("component:components/jquery-ui-pbox/pbox.js"),e("component:components/underscore/underscore.js"));n.templateSettings={escape:/{%-([\s\S]+?)%}/g,evaluate:/{%([\s\S]+?)%}/g,interpolate:/{%=([\s\S]+?)%}/g};var s=o.widget("ui.verificationCode",{options:{container:"body",containerClass:"",width:290,height:70,codeWidth:150,codeClass:"",imgWidth:100,imgClass:"",channel:1,funcName:"login",changeAnother:!1,success:o.noop()},api:{getImg:"/component/captcha/image?appId=1&funcName=login&channel=",verifyCode:"/component/captcha/verify"},_create:function(){var e='<div id="verify-token-container"><div class="verify-token"><input type="text" placeholder="验证码" autocomplete="off" tabindex="3" maxlength="4" name="entered_imagecode"><img class="token-img" class="js-change-token" title="验证码" alt="验证码" src="'+this.api.getImg+this.options.channel+"&time="+(new Date).getTime()+'"><a href="javascript:void(0);" class="js-change-token" style="display: none;">换一张</a></div><div class="error-message" style="display: none;">验证码错误</div></div>';this.$verificationCode=o(e),this.$verificationCode.appendTo(this.options.container),this.options.changeAnother&&this.$verificationCode.find(".js-change-token").show(),this._setStyle(),this._bindEvent()},_setStyle:function(){this.$verificationCode.css({width:this.options.width,height:this.options.height}).addClass(this.options.containerClass).find("img").css({width:this.options.imgWidth}).addClass(this.options.imgClass).end().find("input").css({width:this.options.codeWidth}).addClass(this.options.codeClass)},_getImgCode:function(){o(".token-img",this.$verificationCode).attr("src",this.api.getImg+this.options.channel+"&time="+(new Date).getTime())},_bindEvent:function(){var e=this,i="",t=e.$verificationCode.find(".error-message");this.$verificationCode.on("click","img,a",function(){e._getImgCode()}),this.$verificationCode.on("keyup","input",function(n){var s=o(n.target),c=s.val();i==c||c.length<4||(i=c,o.post(e.api.verifyCode,{cptId:o.cookie("cpt_id"),funcName:e.options.funcName,channel:e.options.channel,code:c,appId:1}).done(function(i){0===i.code?(t.hide(),"function"==typeof e.options.success&&e.options.success({ticket:i.data.ticket||"",verifyStatus:!0})):(t.text(i.msg||"验证码错误").show(),e.$verificationCode.find("img").trigger("click"))}))})},_destroy:function(){}});t.exports=s});
//# sourceMappingURL=//bstatic.nuomi.com/bnuomi/tuanb/static/components/lbc-verification-code/verificationCode__5c224d0.map